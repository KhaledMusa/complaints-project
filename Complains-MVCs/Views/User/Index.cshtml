@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var userObjectJson = ViewBag.UserObjectJson;
    var userObject = Newtonsoft.Json.JsonConvert.DeserializeObject<User>(userObjectJson);
}

<h1>Complains</h1>

@if (userObjectJson != null)
{
    <script>
        // Parse the JSON data received from the controller action
        var userData = @Html.Raw(userObjectJson);

        // Check if userData is not empty (user is logged in)
        if (userData) {
            // Save user data in session storage
            sessionStorage.setItem('userData', JSON.stringify(userData));
            console.log('User data saved in session storage:', userData);
        }
    </script>
}
<table class="table table-striped table-borderd table-hover">
    <tr>

        <th style="text-align:center">Text</th>
        <th style="text-align:center">ContetType</th>
        <th style="text-align:center">Status</th>
        <th style="text-align:center">UserId</th>
        <th style="text-align:center">Demands</th>
        
    </tr>
    @if (Model != null)
    {
        @foreach (var Potato in Model)
        {
            <tr>

                <td style ="text-align:center">@Potato.Text</td>
                <td style ="text-align:center">@Potato.ContentType</td>
                <td style="text-align:center" >
                
                        @if (userObject.TypeOfUser == "Admin")
                        {

                        <a asp-action="CheckedComp" asp-controller="User" asp-route-id="@Potato.Id" class="btn btn-outline-info" >View</a>
                        <a asp-action="Rejected" asp-controller="Admin" asp-route-id="@Potato.Id" class="btn btn-outline-danger">Rejected</a><br />
                        <br />
                        <br />
                        @Potato.Status
                        }
                        else if (userObject.TypeOfUser == "User")
                        {
                            @Potato.Status
                            @if (Potato.Status != "Accepted")
                            {
                            <a asp-action="UpdateComp" asp-controller="User" asp-route-id="@Potato.Id" class="btn btn-outline-warning">Edit</a>
                            }
                            
                        }

                </td>
                <td style ="text-align:center">@Potato.UserId</td>
                <td style="text-align:center">
                    @if (Potato.Demands != null)
                    {
                        foreach (var demand in Potato.Demands)
                        {
                            <div>
                                <!-- Output the labels behind the values -->
                                <h6>Type : @demand.Description</h6>  <br />
                                <h6>CompId : @demand.FileCompId</h6>  <br />
                                <hr>
                            </div>
                        }
                    }
                </td>
                
            </tr>
        }
    }


</table>
<div>
    <a asp-action="Create">Create New Compliants</a>
</div>
<div>
    <a asp-action="GetProfile">My profile</a>
</div>



<h1> user logged in in index page</h1>
@* <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
    $.ajax({
        url: "https://localhost:5159/api/Users/Getcomplaints",
        success: function (data) {
            console.log(data);
            $("#results").append(html);
        }
                error: function (data) {
            alert("faild");
        }

    });
 *@
</script>

<!-- Rest of your HTML content for the Index view -->
